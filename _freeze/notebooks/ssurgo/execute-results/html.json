{
    "hash": "468ca32274e1d4fdafe780dff882a21c",
    "result": {
        "engine": "jupyter",
        "markdown": "---\njupyter: python3\nauthor: Corey T. White\nexecute:\n  eval: true\n  freeze: auto\ndate-modified: today\nformat:\n  html:\n    toc: true\n    code-tools: true\n    code-copy: true\n    code-fold: false\n---\n\n# SSURGO Soil Data in GRASS\n\n\n\n::: {#99503f05 .cell execution_count=2}\n``` {.python .cell-code}\ngisdb = os.path.join(os.getenv(\"HOME\"), \"grassdata\")\nsite = \"clay-center\"\nmapset = \"ssurgo_demo\"\nsession = gj.init(gisdb, site, \"PERMANENT\")\ntools = Tools(session=session)\n# tools.g_mapset(mapset=mapset, flags=\"c\")\n```\n:::\n\n\nInstall addon\n\n::: {#6fc3a49a .cell execution_count=3}\n``` {.python .cell-code}\ntools.g_extension(\n    extension=\"r.in.ssurgo\",\n    url=\"../tools/r.soildb/r.in.ssurgo\",\n)\n```\n:::\n\n\n::: {#ef5c6dd8 .cell execution_count=4}\n``` {.python .cell-code}\nregion_text = tools.g_region(raster=\"elevation\", flags=\"p\").text\ntools.r_relief(input=\"elevation\", output=\"relief\")\n\nprint(region_text)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nprojection: 1 (UTM)\nzone:       14\ndatum:      wgs84\nellipsoid:  wgs84\nnorth:      4363578.81553571\nsouth:      4362417.81553571\nwest:       666092.80807312\neast:       667469.80807312\nnsres:      3\newres:      3\nrows:       387\ncols:       459\ncells:      177633\n```\n:::\n:::\n\n\n::: {#9f122160 .cell execution_count=5}\n``` {.python .cell-code}\ntools.r_in_ssurgo(\n    ssurgo_path=\"../data/gSSURGO_CONUS.zip/gSSURGO_CONUS.gdb\",\n    ssurgo_areas=\"soil_areas\",\n    hydgrp=\"hydgrp\",\n    ksat_l=\"ksat_l\",\n    ksat_r=\"ksat_r\",\n    ksat_h=\"ksat_h\",\n    mukey=\"mukey\",\n    hzdept_r=0,\n    hzdepb_r=100,\n    desgnmaster=\"A\",\n    overwrite=True,\n)\n```\n:::\n\n\n::: {#d7ec6a76 .cell execution_count=6}\n``` {.python .cell-code}\ntools.g_list(type=\"vector\", mapset=mapset)\n```\n:::\n\n\n::: {#f323f095 .cell execution_count=7}\n``` {.python .cell-code}\njson_data = tools.v_db_select(map=\"clay_center_mupolygon\", format=\"json\").json\n\ndf = pd.DataFrame(json_data[\"records\"])\n\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=44}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>cat</th>\n      <th>mukey</th>\n      <th>cokey</th>\n      <th>compname</th>\n      <th>comppct_r</th>\n      <th>runoff</th>\n      <th>hydgrp</th>\n      <th>hydricon</th>\n      <th>hydricrating</th>\n      <th>drainagecl</th>\n      <th>ksat_l</th>\n      <th>ksat_r</th>\n      <th>ksat_h</th>\n      <th>hsg</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>2668916</td>\n      <td>25832777</td>\n      <td>Geary</td>\n      <td>3</td>\n      <td>Medium</td>\n      <td>C</td>\n      <td>None</td>\n      <td>No</td>\n      <td>Well drained</td>\n      <td>11.528542</td>\n      <td>24.135253</td>\n      <td>37.834778</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>2668916</td>\n      <td>25832779</td>\n      <td>Hobbs</td>\n      <td>3</td>\n      <td>Low</td>\n      <td>B</td>\n      <td>None</td>\n      <td>No</td>\n      <td>Well drained</td>\n      <td>11.528542</td>\n      <td>24.135253</td>\n      <td>37.834778</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>2668916</td>\n      <td>25832778</td>\n      <td>Hastings</td>\n      <td>2</td>\n      <td>Medium</td>\n      <td>C</td>\n      <td>None</td>\n      <td>No</td>\n      <td>Well drained</td>\n      <td>11.528542</td>\n      <td>24.135253</td>\n      <td>37.834778</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>2668916</td>\n      <td>25832776</td>\n      <td>Aquolls</td>\n      <td>1</td>\n      <td>Negligible</td>\n      <td>D</td>\n      <td>Wooded under natural conditions</td>\n      <td>Yes</td>\n      <td>Poorly drained</td>\n      <td>11.528542</td>\n      <td>24.135253</td>\n      <td>37.834778</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>2668916</td>\n      <td>25832780</td>\n      <td>Lancaster</td>\n      <td>1</td>\n      <td>Medium</td>\n      <td>C</td>\n      <td>None</td>\n      <td>No</td>\n      <td>Well drained</td>\n      <td>11.528542</td>\n      <td>24.135253</td>\n      <td>37.834778</td>\n      <td>3</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Ksat Maps\n\n### Regular\n\n::: {#8a74cbda .cell execution_count=8}\n``` {.python .cell-code}\nm = gj.Map(use_region=True)\nm.d_shade(shade=\"relief\", color=\"ksat_r\")\nm.d_legend(raster=\"ksat_r\", title=\"Ksat (mm/hr)\", flags=\"b\")\nm.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](ssurgo_files/figure-html/cell-9-output-1.png){}\n:::\n:::\n\n\n### High\n\n::: {#ef94a934 .cell execution_count=9}\n``` {.python .cell-code}\nm = gj.Map(use_region=True)\nm.d_shade(shade=\"relief\", color=\"ksat_h\")\nm.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](ssurgo_files/figure-html/cell-10-output-1.png){}\n:::\n:::\n\n\n### Low\n\n::: {#d1340884 .cell execution_count=10}\n``` {.python .cell-code}\nm = gj.Map(use_region=True)\nm.d_rast(map=\"ksat_l\")\nm.d_shade(shade=\"relief\", color=\"ksat_l\")\nm.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](ssurgo_files/figure-html/cell-11-output-1.png){}\n:::\n:::\n\n\n## Hydrologic Group\n\n::: {#d181822a .cell execution_count=11}\n``` {.python .cell-code}\nm = gj.Map(use_region=True)\nm.d_rast(map=\"hsg\")\nm.d_shade(shade=\"relief\", color=\"hsg\")\nm.d_legend(raster=\"hsg\", title=\"Hd\", flags=\"b\")\nm.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](ssurgo_files/figure-html/cell-12-output-1.png){}\n:::\n:::\n\n\n::: {#ce869e44 .cell execution_count=12}\n``` {.python .cell-code}\ntools.g_list(type=\"raster\", mapset=\"PERMANENT\")\n```\n\n::: {.cell-output .cell-output-display execution_count=49}\n```\nToolResult(returncode=0, stdout='comppct_r\ndepth\ndischarge\ndx\ndy\nelevation\nhsg\nksat_h\nksat_l\nksat_r\nrelief\nssurgo_mukey\ntri\n', stderr='')\n```\n:::\n:::\n\n\n## Run model\n\n::: {#e841f317 .cell execution_count=13}\n``` {.python .cell-code}\ntools.r_slope_aspect(elevation=\"elevation\", dx=\"dx\", dy=\"dy\")\n\n\ntools.r_sim_water(\n    elevation=\"elevation\", depth=\"depth\", discharge=\"discharge\"\n)\n```\n:::\n\n\n::: {#914176fc .cell execution_count=14}\n``` {.python .cell-code}\nm = gj.Map(use_region=True)\nm.d_rast(map=\"depth\")\nm.d_shade(shade=\"relief\", color=\"depth\")\nm.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](ssurgo_files/figure-html/cell-15-output-1.png){}\n:::\n:::\n\n\n::: {#d6c37f22 .cell execution_count=15}\n``` {.python .cell-code}\nm = gj.Map(use_region=True)\nm.d_rast(map=\"discharge\")\nm.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](ssurgo_files/figure-html/cell-16-output-1.png){}\n:::\n:::\n\n\n",
        "supporting": [
            "ssurgo_files"
        ],
        "filters": [],
        "includes": {
            "include-in-header": [
                "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
            ]
        }
    }
}
